//===============================================================
//===============================================================
//==== LMC Board Representation
//===============================================================
//===============================================================
// REQUIRES: GobstonesAmenities
// REQUIRES: GobstonesLists
// REQUIRES: LMCForm
// REQUIRES: LMCMem
// REQUIRES: LMCModel


//----------------------------------------------------------
// LMC's Board Representation 
//----------------------------------------------------------
//type LMCBoardRep is LMCForm(
//    /* The lm and bounds have several states... */
//      lm       -> (Color, Lista de Números)
//    , pc       -> (Color, Número)
//    , acc      -> (Color, Número)
//    , neg      -> (Color, Número)
//    , inp      -> (Color, Número)
//    , out      -> (Color, Número)
//    , mbs      -> (Color, Número)
//    , bounds   -> (Color, Lista de Números)
//    , wz       -> (Color, Número)
//    , iz       -> (Color, Número)
//    , dz       -> (Color, Número)
//    , contents -> (Color, Número)
//}

//----------------------------------------------------------
function lmcRepresentation() {
   /* PURPOSE: describes a LMCForm of type LMCBoardRep, with a representation of an LMC
      PRECONDITIONS: none
  */
  return (LMCForm(lm       <- (Verde, [ 11, 1 ])      // The Little Man representation (Halted, Active)
                , pc       <- (Negro, 10)             // The Program Counter place representation
                , acc      <- (Negro, 11)             // The Accumulator place representation
                , neg      <- (Negro, 12)             // The NEGative flag place representation
                , inp      <- (Negro,  2)             // The INPut place representation
                , out      <- (Negro,  3)             // The OUTput place representation
                , mbs      <- (Negro,  1)             // The MailBoxeS places representation
                , bounds   <- (Rojo , [1,2,3,4,5,6])  // The BOUNDS are walls representation (Vertical, Horizontal, NO(N), NE(E), SE(S), SO(O)
                , wz       <- (Negro, 20)             // The Working Zone place representation
                , iz       <- (Negro, 21)             // The Instruction Zone place representation
                , dz       <- (Negro, 22)             // The Data Zone place representation
                , contents <- (Azul ,  0)             // The numeric CONTENTS of mailboxes; any number will do
         ))
}

function lmcRep_cornerWall_(lmcRep, direction) {
  let (color, valores) := bounds(lmcRep)
  return (color, elemAt_In_(aux_corner2Index(direction), valores))
}

function aux_corner2Index(dir) {
   return (matching (dir) select
             2 on Norte
             3 on Este
             4 on Sur
             5 otherwise
          )
}

function lmcRep_straigthWallInDir_(lmcRep, dir) {
  let (color, valores) := bounds(lmcRep)
  return (color, choose segundo(valores) when (aux_isHorizontal_(dir)) 
                        primero(valores) otherwise)
}

function aux_isHorizontal_(dir) { return (dir==Norte || dir==Sur) }

function lmcRep_contents_(lmcRep, value) { return(aux_modifyValueOf_With_(contents(lmcRep), value)) }

function aux_modifyValueOf_With_(elemRep, value) {
  return((fst(elemRep), value))
}

function aux_colorOf_(elemRep) {
  let (color, value) := elemRep
  return (color)
}

function aux_cantOf_(elemRep) {
  let (color, value) := elemRep
  return (value)
}

function lmcRep_haltedLM(lmRep) {
  let (color, valores) := lm(lmRep)
  return (color, primero(valores))
}

function lmcRep_activeLM(lmRep) {
  let (color, valores) := lm(lmRep)
  return (color, segundo(valores))
}

